{"ast":null,"code":"const puppeteer = require(\"puppeteer\");\n\nfunction scrapeFacebook(link) {\n  (async () => {\n    var browser = await puppeteer.launch({\n      headless: false\n    });\n    var page = await browser.newPage();\n    await page.goto(link, {\n      waitUntil: 'networkidle2'\n    });\n    let facebookStats = await page.evaluate(() => {\n      var name = document.querySelector('a[class=\"_64-f\"]').innerText;\n      var likes = document.querySelectorAll('div[class=\"_4-u2 _6590 _3xaf _4-u8\"] > div > div > div')[1].innerText;\n      var followers = document.querySelectorAll('div[class=\"_4-u2 _6590 _3xaf _4-u8\"] > div > div')[2].innerText;\n      var website = document.querySelector('#u_0_q_x4').innerText;\n      var category = document.querySelectorAll('div[class=\"_4-u2 _u9q _3xaf _4-u8\"] > div ')[3].innerText;\n      var type = 'facebook';\n      var url = req.body.facebooklink;\n      return {\n        type,\n        url,\n        name,\n        likes,\n        followers,\n        website,\n        category\n      };\n    });\n    console.log(facebookStats);\n  })();\n} //import { Puppeteer } from \"puppeteer\"\n\n\nexport default ((req, res) => {\n  console.log(req.body)(async () => {\n    var browser = await puppeteer.launch({\n      headless: false\n    });\n    var page = await browser.newPage(); //goes to the youtube link (routed to about page)\n\n    if (req.body.youtubelink) {\n      const ytAboutLink = req.body.youtubelink + '/about';\n      await page.goto(ytAboutLink, {\n        waitUntil: 'networkidle2'\n      });\n      let youtubeStats = await page.evaluate(() => {\n        console.log(document.querySelector('#channel-name').innerText);\n        var name = document.querySelector('#channel-name').innerText;\n        var description = document.querySelector('#description').innerText; //var rightColumn = document.querySelectorAll('#right-column > yt-formatted-string')[2].innerText;\n\n        var views = '100,000';\n        var subscribers = document.querySelector('#subscriber-count').innerText;\n        var type = 'youtube';\n        var url = req.body.youtubelink;\n        return {\n          type,\n          url,\n          name,\n          description,\n          views,\n          subscribers\n        };\n      });\n      console.log(youtubeStats);\n    } //gos to the facebook link\n\n\n    if (req.body.facebooklink) scrapeFacebook(req.body.facebooklink); //go to instagram\n\n    if (req.body.instagramlink) {\n      await page.goto(req.body.instagramlink, {\n        waitUntil: 'networkidle2'\n      });\n      let instagramStats = await page.evaluate(() => {\n        const mainStats = document.querySelectorAll('span[class=\"g47SY \"]');\n        var username = document.querySelector('h2[class=\"_7UhW9       fKFbl yUEEX   KV-D4              fDxYl     \"]').innerText;\n        var name = document.querySelector('h1[class=\"rhpdm\"]').innerText; //change title to innerText to be formatted the way instagram does. \n\n        var numPosts = mainStats[0].innerText;\n        var numFollowers = mainStats[1].title;\n        var numFollowing = mainStats[2].innerText;\n        var bio = document.querySelector('div[class=\"-vDIg\"] > span').innerText;\n        var website = document.querySelector('div[class=\"-vDIg\"] > a').innerText;\n        var type = 'instagram';\n        var url = req.body.instagramlink;\n        return {\n          type,\n          url,\n          username,\n          name,\n          bio,\n          website,\n          numFollowers,\n          numPosts,\n          numFollowing\n        };\n      });\n      console.log(instagramStats);\n    }\n    /* planning on how im gonna output this thing\n    obj = {facebookstats, instagramstats, youtubestats}\n    fs.writeFile(\"./\" + new Date().toString() + \".txt\", JSON.stringify(obj), function(err) {\n        if(err) {\n            return console.log(err);\n        }\n    \n        console.log(\"The file was saved!\");\n    }); \n    */\n\n\n    await browser.close();\n  })();\n  res.status(200).json({\n    info: 'scrape page',\n    name: req.body.name\n  });\n});","map":{"version":3,"sources":["/Users/robertobrien/Documents/projects/ghost-scraper/pages/api/scrapePage.js"],"names":["puppeteer","require","scrapeFacebook","link","browser","launch","headless","page","newPage","goto","waitUntil","facebookStats","evaluate","name","document","querySelector","innerText","likes","querySelectorAll","followers","website","category","type","url","req","body","facebooklink","console","log","res","youtubelink","ytAboutLink","youtubeStats","description","views","subscribers","instagramlink","instagramStats","mainStats","username","numPosts","numFollowers","title","numFollowing","bio","close","status","json","info"],"mappings":"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","sourcesContent":["const puppeteer = require(\"puppeteer\");\n\nfunction scrapeFacebook(link) {\n    (async () => { \n        var browser = await puppeteer.launch({headless: false});\n        var page = await browser.newPage(); \n\n\n        await page.goto(link, {waitUntil: 'networkidle2'});\n\n        let facebookStats = await page.evaluate(() => {\n            var name = document.querySelector('a[class=\"_64-f\"]').innerText;\n            var likes = document.querySelectorAll('div[class=\"_4-u2 _6590 _3xaf _4-u8\"] > div > div > div')[1].innerText\n            var followers = document.querySelectorAll('div[class=\"_4-u2 _6590 _3xaf _4-u8\"] > div > div')[2].innerText;\n            var website = document.querySelector('#u_0_q_x4').innerText;\n            var category = document.querySelectorAll('div[class=\"_4-u2 _u9q _3xaf _4-u8\"] > div ')[3].innerText;\n\n            var type = 'facebook';\n            var url = req.body.facebooklink;\n\n            return {\n                type,\n                url,\n                name,\n                likes,\n                followers,\n                website,\n                category,\n            }\n        })\n\n        console.log(facebookStats);\n    })();\n\n}\n\n\n//import { Puppeteer } from \"puppeteer\"\nexport default (req, res) => {\n\n    console.log(req.body)\n\n    (async () => { \n    var browser = await puppeteer.launch({headless: false});\n    var page = await browser.newPage(); \n\n    //goes to the youtube link (routed to about page)\n    if(req.body.youtubelink)\n   {\n        const ytAboutLink = req.body.youtubelink + '/about';\n        await page.goto(ytAboutLink, {waitUntil: 'networkidle2'});\n        \n        let youtubeStats = await page.evaluate(() => {\n\n            console.log(document.querySelector('#channel-name').innerText);\n\n            var name = document.querySelector('#channel-name').innerText;\n            var description = document.querySelector('#description').innerText;\n            //var rightColumn = document.querySelectorAll('#right-column > yt-formatted-string')[2].innerText;\n            var views = '100,000';\n            var subscribers = document.querySelector('#subscriber-count').innerText;\n\n\n            var type = 'youtube';\n            var url = req.body.youtubelink;\n\n            return {\n                type,\n                url,\n                name,\n                description,\n                views,\n                subscribers,\n            }\n        })\n\n        console.log(youtubeStats);\n    }\n\n    //gos to the facebook link\n    if(req.body.facebooklink)\n        scrapeFacebook(req.body.facebooklink);\n\n    //go to instagram\n    if(req.body.instagramlink)\n    {\n        await page.goto(req.body.instagramlink, {waitUntil: 'networkidle2'});\n\n        let instagramStats = await page.evaluate(() => {\n\n            const mainStats = document.querySelectorAll('span[class=\"g47SY \"]');\n            \n            var username = document.querySelector('h2[class=\"_7UhW9       fKFbl yUEEX   KV-D4              fDxYl     \"]').innerText;\n            var name = document.querySelector('h1[class=\"rhpdm\"]').innerText;\n\n            //change title to innerText to be formatted the way instagram does. \n            var numPosts = mainStats[0].innerText; \n            var numFollowers = mainStats[1].title;\n            var numFollowing = mainStats[2].innerText;\n\n            var bio = document.querySelector('div[class=\"-vDIg\"] > span').innerText;\n            var website = document.querySelector('div[class=\"-vDIg\"] > a').innerText;\n\n            var type = 'instagram';\n            var url = req.body.instagramlink;\n\n            return {\n                type,\n                url,\n                username,\n                name,\n                bio, \n                website,\n                numFollowers,\n                numPosts,\n                numFollowing,\n            }\n        })\n\n        console.log(instagramStats);\n    }\n\n    /* planning on how im gonna output this thing\n    obj = {facebookstats, instagramstats, youtubestats}\n    fs.writeFile(\"./\" + new Date().toString() + \".txt\", JSON.stringify(obj), function(err) {\n        if(err) {\n            return console.log(err);\n        }\n    \n        console.log(\"The file was saved!\");\n    }); \n    */\n\n    await browser.close();\n\n    })();\n\n\n    res.status(200).json({ info: 'scrape page', name: req.body.name })\n  }\n  "]},"metadata":{},"sourceType":"module"}