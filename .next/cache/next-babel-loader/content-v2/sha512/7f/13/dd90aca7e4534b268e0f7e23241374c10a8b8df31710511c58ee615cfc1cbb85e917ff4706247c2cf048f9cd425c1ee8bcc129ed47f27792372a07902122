{"ast":null,"code":"import next from \"next\";\n\nconst puppeteer = require(\"puppeteer\");\n\nexport default ((req, res) => {\n  (async () => {\n    const browser = await puppeteer.launch({\n      headless: false\n    });\n    const page = await browser.newPage();\n    await page.goto('https://www.cvs.com/vaccine/intake/store/covid-screener/covid-qns', {\n      waitUntil: 'networkidle2'\n    });\n    await page.setViewport({\n      width: 1440,\n      height: 746\n    });\n    await page.waitForSelector('.form-group:nth-child(3) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    await page.click('.form-group:nth-child(3) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    await page.waitForSelector('.form-group:nth-child(4) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    await page.click('.form-group:nth-child(4) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    await page.waitForSelector('.form-group:nth-child(5) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    await page.click('.form-group:nth-child(5) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    await sleep(1000);\n    await page.waitForSelector('.imz-bg > cvs-covid-questionnaire > #content > .footer-content-wrapper > .btn-control');\n    await page.click('.imz-bg > cvs-covid-questionnaire > #content > .footer-content-wrapper > .btn-control');\n    await page.waitForSelector('.form-group > .row > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label');\n    await page.click('.form-group > .row > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label');\n    await sleep(1000);\n    await page.waitForSelector('.imz-bg > cvs-covid-dose-selection > #content > .footer-content-wrapper > .btn-control');\n    await page.click('.imz-bg > cvs-covid-dose-selection > #content > .footer-content-wrapper > .btn-control');\n    await page.waitForSelector('#generic #jurisdiction');\n    await page.click('#generic #jurisdiction');\n    await page.select('#generic #jurisdiction', '42: EID_VA');\n    await sleep(1000);\n    await page.waitForSelector('.imz-bg > cvs-eligibility-covid > #content > .footer-content-wrapper > .btn-control');\n    await page.click('.imz-bg > cvs-eligibility-covid > #content > .footer-content-wrapper > .btn-control');\n    await page.waitForSelector('fieldset #q1_0');\n    await page.click('fieldset #q1_0');\n    await page.type(req.body.age);\n\n    if (parseInt(req.body.age) < 65) {\n      await page.waitForSelector('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label');\n      await page.click('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label');\n    } else {\n      await page.waitForSelector('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label');\n      await page.click('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label');\n    }\n\n    await page.waitForSelector('fieldset #consentText');\n    await page.click('fieldset #consentText');\n    await sleep(1000);\n    await page.waitForSelector('.imz-bg > cvs-eligibility-questionnaire > #content > .footer-content-wrapper > .btn-control');\n    await page.click('.imz-bg > cvs-eligibility-questionnaire > #content > .footer-content-wrapper > .btn-control');\n    await sleep(1000);\n    await page.waitForSelector('.imz-bg > cvs-cvd-how-to-schedule > #content > .footer-content-wrapper > .btn-control');\n    await page.click('.imz-bg > cvs-cvd-how-to-schedule > #content > .footer-content-wrapper > .btn-control');\n    await page.waitForSelector('#generic #address');\n    await page.click('#generic #address');\n    await page.type(req.body.zipcode);\n    await page.waitForSelector('.form-group > .row > .flex-container > .search-icon > img');\n    await page.click('.form-group > .row > .flex-container > .search-icon > img');\n    await sleep(1000);\n    await browser.close();\n  })();\n\n  res.status(200).json({\n    info: 'scrape page',\n    name: req.body.name\n  });\n});","map":{"version":3,"sources":["/Users/robertobrien/Documents/projects/vaccine-signup/pages/api/scrapePage.js"],"names":["next","puppeteer","require","req","res","browser","launch","headless","page","newPage","goto","waitUntil","setViewport","width","height","waitForSelector","click","sleep","select","type","body","age","parseInt","zipcode","close","status","json","info","name"],"mappings":"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","sourcesContent":["import next from \"next\";\n\nconst puppeteer = require(\"puppeteer\");\n\nexport default (req, res) => {\n\n    (async () => { \n\n    const browser = await puppeteer.launch({headless: false})\n    const page = await browser.newPage()\n    \n    await page.goto('https://www.cvs.com/vaccine/intake/store/covid-screener/covid-qns', {waitUntil: 'networkidle2'});\n    \n    await page.setViewport({ width: 1440, height: 746 });\n  \n    await page.waitForSelector('.form-group:nth-child(3) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n    await page.click('.form-group:nth-child(3) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n\n    \n    await page.waitForSelector('.form-group:nth-child(4) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n    await page.click('.form-group:nth-child(4) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n    \n    await page.waitForSelector('.form-group:nth-child(5) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n    await page.click('.form-group:nth-child(5) > fieldset > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n\n    await sleep(1000);\n    \n    await page.waitForSelector('.imz-bg > cvs-covid-questionnaire > #content > .footer-content-wrapper > .btn-control')\n    await page.click('.imz-bg > cvs-covid-questionnaire > #content > .footer-content-wrapper > .btn-control')\n    \n    await page.waitForSelector('.form-group > .row > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label')\n    await page.click('.form-group > .row > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label')\n\n    await sleep(1000);\n    \n    await page.waitForSelector('.imz-bg > cvs-covid-dose-selection > #content > .footer-content-wrapper > .btn-control')\n    await page.click('.imz-bg > cvs-covid-dose-selection > #content > .footer-content-wrapper > .btn-control')\n    \n    await page.waitForSelector('#generic #jurisdiction')\n    await page.click('#generic #jurisdiction')\n    \n    await page.select('#generic #jurisdiction', '42: EID_VA')\n\n    await sleep(1000);\n    \n    await page.waitForSelector('.imz-bg > cvs-eligibility-covid > #content > .footer-content-wrapper > .btn-control')\n    await page.click('.imz-bg > cvs-eligibility-covid > #content > .footer-content-wrapper > .btn-control')\n    \n    await page.waitForSelector('fieldset #q1_0')\n    await page.click('fieldset #q1_0')\n    await page.type(req.body.age);\n    \n\n    if(parseInt(req.body.age) < 65)\n    {\n        await page.waitForSelector('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label')\n        await page.click('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label')\n    }\n    else\n    {\n        await page.waitForSelector('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(1) > label')\n        await page.click('.form-group > .radio-btn-wrapper > .radio-btn-wrapper > .radioBtn-control:nth-child(2) > label')\n    }\n    \n    \n    await page.waitForSelector('fieldset #consentText')\n    await page.click('fieldset #consentText')\n\n    await sleep(1000);\n    \n    await page.waitForSelector('.imz-bg > cvs-eligibility-questionnaire > #content > .footer-content-wrapper > .btn-control')\n    await page.click('.imz-bg > cvs-eligibility-questionnaire > #content > .footer-content-wrapper > .btn-control')\n\n    await sleep(1000);\n    \n    await page.waitForSelector('.imz-bg > cvs-cvd-how-to-schedule > #content > .footer-content-wrapper > .btn-control')\n    await page.click('.imz-bg > cvs-cvd-how-to-schedule > #content > .footer-content-wrapper > .btn-control')\n    \n    await page.waitForSelector('#generic #address')\n    await page.click('#generic #address')\n    await page.type(req.body.zipcode)\n\n    \n    await page.waitForSelector('.form-group > .row > .flex-container > .search-icon > img')\n    await page.click('.form-group > .row > .flex-container > .search-icon > img')\n    \n    await sleep(1000);\n    \n    await browser.close()\n        })();\n\n\n    res.status(200).json({ info: 'scrape page', name: req.body.name })\n  }\n  "]},"metadata":{},"sourceType":"module"}