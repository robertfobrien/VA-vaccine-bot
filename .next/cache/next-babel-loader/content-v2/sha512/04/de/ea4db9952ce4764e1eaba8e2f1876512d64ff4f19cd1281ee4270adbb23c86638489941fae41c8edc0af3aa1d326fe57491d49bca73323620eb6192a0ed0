{"ast":null,"code":"import { Puppeteer } from \"puppeteer\"; // This is the script\n// based on req.body, call some api to get a webpage\n// scrap page\n// return json here\n\nexport default ((req, res) => {\n  const puppeteer = require(\"puppeteer\");\n\n  (async () => {\n    var browser = await puppeteer.launch({\n      headless: false\n    });\n    var page = await browser.newPage(); //gos to the facebook link\n\n    await page.goto(req.body.facebooklink, {\n      waitUntil: 'networkidle2'\n    });\n    let facebookStats = await page.evaluate(() => {\n      var followers = document.querySelector('span[class=\"d2edcug0 hpfvmrgz qv66sw1b c1et5uql oi732d6d ik7dh3pa fgxwclzu a8c37x1j keod5gw0 nxhoafnm aigsh9s9 d9wwppkn fe6kdd0r mau55g9w c8b282yb iv3no6db jq4qci2q a3bd9o3v knj5qynh oo9gr5id hzawbc8m\"]').innerText;\n      var name = document.querySelector('h1[class=\"gmql0nx0 l94mrbxd p1ri9a11 lzcic4wl bp9cbjyn j83agx80\"]').innerText;\n      var website = document.querySelector('span[class=\"d2edcug0 hpfvmrgz qv66sw1b c1et5uql oi732d6d ik7dh3pa fgxwclzu a8c37x1j keod5gw0 nxhoafnm aigsh9s9 d9wwppkn fe6kdd0r mau55g9w c8b282yb iv3no6db jq4qci2q a3bd9o3v knj5qynh oo9gr5id hzawbc8m\"] > a').innerText; //must be in the ' ....facebook.com..../about' page\n      //var category = document.querySelector('div[class=\"ii04i59q a3bd9o3v jq4qci2q oo9gr5id\"]').innerText;\n\n      return {\n        name,\n        followers,\n        website\n      };\n    });\n    console.log(facebookStats); //goes to the youtube link \n\n    const ytAboutLink = req.body.youtubelink + '/about';\n    await page.goto(ytAboutLink); //makes sure the page is loaded\n\n    await document.querySelector('#channel-name').innerText;\n    let youtubeStats = await page.evaluate(() => {\n      var name = document.querySelector('#channel-name').innerText;\n      var description = document.querySelector('#description').innerText;\n      var rightColumn = document.querySelectorAll('#right-column > yt-formatted-string')[2].innerText;\n      var views = rightColumn[2].innerText;\n      var subscribers = document.querySelector('#subscriber-count').innerText;\n      return {\n        name,\n        description,\n        views,\n        subscribers\n      };\n    });\n    console.log(youtubeStats); //go to instagram\n\n    await page.goto(req.body.instagramlink, {\n      waitUntil: 'networkidle2'\n    });\n    let instagramStats = await page.evaluate(() => {\n      const mainStats = document.querySelectorAll('span[class=\"g47SY \"]');\n      var username = document.querySelector('h2[class=\"_7UhW9       fKFbl yUEEX   KV-D4              fDxYl     \"]').innerText;\n      var name = document.querySelector('h1[class=\"rhpdm\"]').innerText; //change title to innerText to be formatted the way instagram does. \n\n      var numPosts = mainStats[0].innerText;\n      var numFollowers = mainStats[1].title;\n      var numFollowing = mainStats[2].innerText;\n      var bio = document.querySelector('div[class=\"-vDIg\"] > span').innerText;\n      var website = document.querySelector('div[class=\"-vDIg\"] > a').innerText;\n      return {\n        name,\n        username,\n        numFollowers,\n        numPosts,\n        numFollowing,\n        bio,\n        website\n      };\n    });\n    console.log(instagramStats);\n    await browser.close();\n  })();\n\n  res.status(200).json({\n    info: 'scrape page',\n    name: req.body.name\n  });\n});","map":{"version":3,"sources":["/Users/robertobrien/Documents/projects/ghost-scraper/pages/api/scrapePage.js"],"names":["Puppeteer","req","res","puppeteer","require","browser","launch","headless","page","newPage","goto","body","facebooklink","waitUntil","facebookStats","evaluate","followers","document","querySelector","innerText","name","website","console","log","ytAboutLink","youtubelink","youtubeStats","description","rightColumn","querySelectorAll","views","subscribers","instagramlink","instagramStats","mainStats","username","numPosts","numFollowers","title","numFollowing","bio","close","status","json","info"],"mappings":"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","sourcesContent":["import { Puppeteer } from \"puppeteer\"\n\n\n// This is the script\n// based on req.body, call some api to get a webpage\n// scrap page\n// return json here\nexport default (req, res) => {\n\n    const puppeteer = require(\"puppeteer\");\n\n    (async () => { \n    var browser = await puppeteer.launch({headless: false});\n    var page = await browser.newPage(); \n\n    //gos to the facebook link\n    await page.goto(req.body.facebooklink, {waitUntil: 'networkidle2'});\n\n    let facebookStats = await page.evaluate(() => {\n\n        var followers = document.querySelector('span[class=\"d2edcug0 hpfvmrgz qv66sw1b c1et5uql oi732d6d ik7dh3pa fgxwclzu a8c37x1j keod5gw0 nxhoafnm aigsh9s9 d9wwppkn fe6kdd0r mau55g9w c8b282yb iv3no6db jq4qci2q a3bd9o3v knj5qynh oo9gr5id hzawbc8m\"]').innerText\n\n        var name = document.querySelector('h1[class=\"gmql0nx0 l94mrbxd p1ri9a11 lzcic4wl bp9cbjyn j83agx80\"]').innerText;\n        var website = document.querySelector('span[class=\"d2edcug0 hpfvmrgz qv66sw1b c1et5uql oi732d6d ik7dh3pa fgxwclzu a8c37x1j keod5gw0 nxhoafnm aigsh9s9 d9wwppkn fe6kdd0r mau55g9w c8b282yb iv3no6db jq4qci2q a3bd9o3v knj5qynh oo9gr5id hzawbc8m\"] > a').innerText;\n        //must be in the ' ....facebook.com..../about' page\n        //var category = document.querySelector('div[class=\"ii04i59q a3bd9o3v jq4qci2q oo9gr5id\"]').innerText;\n\n        return {\n            name,\n            followers,\n            website,\n        }\n    })\n\n    console.log(facebookStats);\n\n    //goes to the youtube link \n    const ytAboutLink = req.body.youtubelink + '/about';\n    await page.goto(ytAboutLink);\n    //makes sure the page is loaded\n    await document.querySelector('#channel-name').innerText;\n\n    let youtubeStats = await page.evaluate(() => {\n\n        var name = document.querySelector('#channel-name').innerText;\n        var description = document.querySelector('#description').innerText;\n        var rightColumn = document.querySelectorAll('#right-column > yt-formatted-string')[2].innerText;\n        var views = rightColumn[2].innerText;\n        var subscribers = document.querySelector('#subscriber-count').innerText;\n\n\n        return {\n            name,\n            description,\n            views,\n            subscribers,\n        }\n    })\n\n    console.log(youtubeStats);\n\n    //go to instagram\n    await page.goto(req.body.instagramlink, {waitUntil: 'networkidle2'});\n\n    let instagramStats = await page.evaluate(() => {\n\n        const mainStats = document.querySelectorAll('span[class=\"g47SY \"]');\n\n        \n        \n        var username = document.querySelector('h2[class=\"_7UhW9       fKFbl yUEEX   KV-D4              fDxYl     \"]').innerText;\n        var name = document.querySelector('h1[class=\"rhpdm\"]').innerText;\n\n        //change title to innerText to be formatted the way instagram does. \n        var numPosts = mainStats[0].innerText; \n        var numFollowers = mainStats[1].title;\n        var numFollowing = mainStats[2].innerText;\n\n        var bio = document.querySelector('div[class=\"-vDIg\"] > span').innerText;\n        var website = document.querySelector('div[class=\"-vDIg\"] > a').innerText;\n\n        return {\n            name,\n            username,\n            numFollowers,\n            numPosts,\n            numFollowing,\n            bio, \n            website,\n        }\n    })\n\n    console.log(instagramStats);\n\n\n    await browser.close();\n\n    })();\n\n\n    \n\n    res.status(200).json({ info: 'scrape page', name: req.body.name })\n  }\n  "]},"metadata":{},"sourceType":"module"}